濄濃濃
濄濈濃
濅濃濃
濅濈濃
濆濃濃
濃
濃濁濈
濄
濄濁濈
濅
濅濁濈
濆
濆濁濈
濇
濇濁濈
濈
濋
濄濃
濄濅
濄濇
濄濉
濃
濃濁濈
濄
濄濁濈
濅
濅濁濈
濆
濆濁濈
濇
濇濁濈
濈
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ
ƾ ƾ
ƾ
ƿ
ƿ
ƿ
ƿ
Unreliability-
aware attention
Actually recorded values
Imputed values, which may not always reflect reality
ƾ
ƿ
Status of patients
Symptoms and signs
Examination of xis
Medical knowledge
Visit i
Visit i+1
Symptom-aware
attention
Dual-
attention
mechanism
determine
evaluate
decide
ht-1
Interpretable embedding
Output ht
xt
T-GRU
T-GRU
ut
Symptom-aware attention
Unreliability-aware attention
Attention
weights
learning
Standard GRU unit
1Ѹ
Time-aware mechanism
Dual-attention mechanism
s
t deep
x
s
t deep
α
u
tα
0/1
s
tc
0/
s
t
true
x
1
1
t

w
1
d
t
h
clinical
IMTS
data
Actual trajectories of different physiological variables
Ă
Ă
Ă
Ă
x.1
ƾ
ƾ
ƿ
ƿ
ƿ
ƿ
ƿ
x.N
Ă
(a) Architecture of the proposed DATA-GRU
(b) Illustration of the dual attention mechanism
Data-quality view
Medical-knowledge view
t
Figure 2: Architecture of DATA-GRU and illustration of dual-attention mechanism. (a) DATA-GRU takes input records xt, time
intervals Δt and unreliability scores ut as inputs. Parts in purple, green, and cyan denote time-aware mechanism, symptom-
aware attention, and unreliability-aware attention, respectively. DATA-GRU handles irregular intervals by converting them into
weights via a decay function to adjust the inﬂuence of previous status on current status. (b) DATA-GRU tackles missing values
by designing a novel dual-attention structure to jointly consider data-quality and medical-knowledge.
Notations
Let D = {(Xk, yk)|k = 1, 2, · · · , K} denote a dataset with
K samples. Each data sample contains a multivariate time
series (MTS) and a target value. We represent MTS of the
kth sample as Xk = (xk
1, · · · , xk
t , · · · , xT k
k) ∈RTk×N,
where N is the number of all input features; Tk is the number
of visits in the kth sample; xk
t (1 ≤t ≤Tk) denotes records
of input features at time t; xt.nk is the value of the nth fea-
ture of xk
t . The two key challenges for irregular MTS (IMTS)
are: a) time irregularities, which refers to varying inter-
vals between successive visits, i.e., the time intervals dataset
{tt −tt−1|t = 1, 2, · · · , Tk} has multiple values; b) missing
values (i.e., several physiological variables are not examined
at some visits because of the changes in symptoms), due to
which the length of each time-series feature is often shorter
than Tk. Thus, we represent Xk as a time series tk
all and a
tuple Sk = (tk, xk), where tk
all = [tk
1, tk
2, · · · , tT k
k] is the list
of timestamps of all visits; tk = [tk
.1, · · · , tk
.n, · · · , tk
.N] is the
list of timestamps for each input feature ( tk
.n(1 ≤k ≤K)
is a subset of tk
all); and xk = [xk
.1, · · · , xk
.n, · · · , xk
.N] is the
corresponding list of recorded input features.
Dual-Attention Time-Aware GRU (DATA-GRU)
The architecture of the proposed DATA-GRU is shown in
Fig.2(a). Compared with standard GRU, DATA-GRU has
two novel components, i.e., time-aware mechanism and
dual-attention mechanism, which simultaneously handles
varying intervals and missing values. The time-aware mech-
anism is introduced to handle irregular intervals. Although
standard GRU (and other variations of RNN) has recursive
formulation and can handle variable-length sequences, but
it can only handle the time-series data with equal intervals
between successive elements. Thus, standard GRU has no
structure to handle irregular intervals with missing values.
However, as mentioned above, processing IMTS data of dif-
ferent patients into equally spaced would seriously damage
data quality, making it nearly impossible to achieve accurate
prediction results. Therefore, we introduce the time-aware
structure to directly handle varying time intervals.
The dual-attention structure is designed to handle miss-
ing values from both data-quality and medical-knowledge
views, as illustrated in Fig.2(b). It is noteworthy that im-
puted values may not always reﬂect reality and are less
reliable than actual records. To achieve accurate and reli-
able predictions, it is suggested to assign smaller weights
to less reliable data and weaken its role by developing an
unreliability-aware attention mechanism. In addition, unlike
other domains, missing values in EHR data may contain im-
portant medical considerations, e.g., whether certain physio-
logical variables are examined or not may indicate the emer-
gence of speciﬁc symptoms and signs. Mining such medical
information will further promote ﬁnal results. Therefore, a
novel symptom-aware attention is proposed to learn medical
information from the medical-knowledge view. The details
of DATA-GRU are presented in the following sections.
Time-aware mechanism. As mentioned above, we only
impute missing values rather than generating equally spaced
data to avoid noise generation. Most methods utilize sim-
ple imputation methods, e.g., forward ﬁlling with past val-
ues and mean value imputation, or their combinations to
handle missing values. However, these methods are inca-
pable of capturing the global structure of time-series data.
Since Gaussian process (GP) can incorporate global struc-
ture information from all available records to conduct im-
putation, we use it to ﬁll missing values in IMTS. For the
kth sample, time series pairs of many variables in the tu-
932
