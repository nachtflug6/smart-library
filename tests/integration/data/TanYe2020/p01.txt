The Thirty-Fourth AAAI Conference on Artiﬁcial Intelligence (AAAI-20)
DATA-GRU: Dual-Attention Time-Aware Gated
Recurrent Unit for Irregular Multivariate Time Series
Qingxiong Tan,1 Mang Ye,1 Baoyao Yang,1 Si-Qi Liu,1 Andy Jinhua Ma,2
Terry Cheuk-Fung Yip,3 Grace Lai-Hung Wong,3 Pong C. Yuen1∗
1Department of Computer Science, Hong Kong Baptist University, Hong Kong
2School of Data and Computer Science, Sun Yat-Sen University, Guangzhou, China
3Department of Medicine and Therapeutics, The Chinese University of Hong Kong, Hong Kong
{csqxtan, mangye, byyang, siqiliu, pcyuen}@comp.hkbu.edu.hk,
{andyjinhuama, terryfungyip}@gmail.com, wonglaihung@cuhk.edu.hk
Abstract
Due to the discrepancy of diseases and symptoms, patients
usually visit hospitals irregularly and different physiological
variables are examined at each visit, producing large amounts
of irregular multivariate time series (IMTS) data with missing
values and varying intervals. Existing methods process IMTS
into regular data so that standard machine learning models
can be employed. However, time intervals are usually de-
termined by the status of patients, while missing values are
caused by changes in symptoms. Therefore, we propose a
novel end-to-end Dual-Attention Time-Aware Gated Recur-
rent Unit (DATA-GRU) for IMTS to predict the mortality
risk of patients. In particular, DATA-GRU is able to: 1) pre-
serve the informative varying intervals by introducing a time-
aware structure to directly adjust the inﬂuence of the previous
status in coordination with the elapsed time, and 2) tackle
missing values by proposing a novel dual-attention structure
to jointly consider data-quality and medical-knowledge. A
novel unreliability-aware attention mechanism is designed to
handle the diversity in the reliability of different data, while a
new symptom-aware attention mechanism is proposed to ex-
tract medical reasons from original clinical records. Extensive
experimental results on two real-world datasets demonstrate
that DATA-GRU can signiﬁcantly outperform state-of-the-art
methods and provide meaningful clinical interpretation.
Introduction
The widely-used electronic health records (EHR) produces
a large quantity of health data, providing valuable oppor-
tunities to develop advanced machine learning methods to
improve healthcare service (Shickel et al. 2017; Liu et al.
2018a). One important task is to predict the mortality risk
of patients based on their historical EHR data. Accurate pre-
diction results help doctors evaluate early treatment effects
and design effective treatment plans (Liu et al. 2018b).
This task is challenging since EHR data consists of irreg-
ular multivariate time series (IMTS), as illustrated in Fig.1.
At different stages of diseases, patients visit hospitals under
varying intervals due to the dynamics of health status. More-
over, different physiological variables are examined at dif-
ferent visits because of the changes in symptoms, e.g., when
Copyright c⃝2020, Association for the Advancement of Artiﬁcial
Intelligence (www.aaai.org). All rights reserved.
Missing values
Base Excess
Free Calcium
Glucose
pCO2
pH
pO2
PT
Visit 1
Visit 4
Visit 3
Visit 2
Visit 5
Visit 6
Visit 7
Time
Figure 1: Illustration of irregular multivariate time series
(IMTS). The time intervals between successive visits vary
signiﬁcantly from each other. Meanwhile, certain physio-
logical variables are not examined at some visits, causing
missing values.
a certain symptom disappears, corresponding variables are
no longer examined, resulting in missing values. The vary-
ing time intervals between successive visits and missing
values raise two key challenges in using IMTS to achieve
accurate mortality risk prediction results. In addition, these
properties provide valuable information in improving pre-
diction performance since they usually reﬂect the health sta-
tus and symptoms of patients.
Machine learning methods have been successfully ap-
plied in many areas, e.g., speech recognition (Afouras et
al. 2018), computer version (Ye et al. 2019a; 2019b; 2019c;
Fu et al. 2019), natural language processing (Camburu et al.
2018), energy prediction (Yuan et al. 2017; 2015; Kang et
al. 2017). The state-of-the-art sequence modeling methods
are recurrent neural networks (RNNs) (Chung et al. 2014;
Pang et al. 2019; Gao et al. 2019). The major limitation of
standard RNN is that it is designed for data with constant
intervals (Baytas et al. 2017), which cannot handle the ir-
regular time-series data. Most clinical prediction methods
convert IMTS into equally spaced by discretizing the time
axis into non-overlapping intervals with a hand-designed in-
terval (Tan et al. 2019; Xu et al. 2018; Tan et al. 2018;
Che et al. 2017; Lipton, Kale, and Wetzel 2016). Then miss-
ing values are ﬁlled via imputation methods. However, when
930
