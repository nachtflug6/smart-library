Published as a conference paper at ICLR 2022
Setting 3: Leave-random-sensors-out. Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup.
Setup. Setting 3 is similar to Setting 2 except that left-out
sensors are randomly selected in each sample instead of being ﬁxed. In each test sample, we select
a subset of sensors and regard them as missing by replacing all of their observations with zeros.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results.
Results. We provide results for the PAM dataset in Table 2 (right block). We ﬁnd that RAINDROP
achieves better performance than baselines in 16 out of 20 settings and that Trans-mean and GRU-D
are the strongest competitors. Further, we evaluated RAINDROP in another setting where the model is
trained on one group of samples (e.g., females) and tested on another group not seen during training
(e.g., males). Experimental setup and results are detailed in Appendix A.13.
Table 2: Classiﬁcation performance on samples with a ﬁxed set of left-out sensors (Setting 2) or random missing
sensors (Setting 3) on the PAM dataset. Results for P19 dataset (Settings 2-3) are shown in Appendix A.12.
Missing
sensor ratio
Methods
PAM (Setting 2: leave-ﬁxed-sensors-out)
PAM (Setting 3: leave-random-sensors-out)
Accuracy
Precision
Recall
F1 score
Accuracy
Precision
Recall
F1 score
10%
Transformer
60.3 ± 2.4
57.8 ± 9.3
59.8 ± 5.4
57.2 ± 8.0
60.9 ± 12.8
58.4 ± 18.4
59.1 ± 16.2
56.9 ± 18.9
Trans-mean
60.4 ± 11.2
61.8 ± 14.9
60.2 ± 13.8
58.0 ± 15.2
62.4 ± 3.5
59.6 ± 7.2
63.7 ± 8.1
62.7 ± 6.4
GRU-D
65.4 ± 1.7
72.6 ± 2.6
64.3 ± 5.3
63.6 ± 0.4
68.4 ± 3.7
74.2 ± 3.0
70.8 ± 4.2
72.0 ± 3.7
SeFT
58.9 ± 2.3
62.5 ± 1.8
59.6 ± 2.6
59.6 ± 2.6
40.0 ± 1.9
40.8 ± 3.2
41.0 ± 0.7
39.9 ± 1.5
mTAND
58.8 ± 2.7
59.5 ± 5.3
64.4 ± 2.9
61.8 ± 4.1
53.4 ± 2.0
54.8 ± 2.7
57.0 ± 1.9
55.9 ± 2.2
RAINDROP
77.2 ± 2.1
82.3 ± 1.1
78.4 ± 1.9
75.2 ± 3.1
76.7 ± 1.8
79.9 ± 1.7
77.9 ± 2.3
78.6 ± 1.8
20%
Transformer
63.1 ± 7.6
71.1 ± 7.1
62.2 ± 8.2
63.2 ± 8.7
62.3 ± 11.5
65.9 ± 12.7
61.4 ± 13.9
61.8 ± 15.6
Trans-mean
61.2 ± 3.0
74.2 ± 1.8
63.5 ± 4.4
64.1 ± 4.1
56.8 ± 4.1
59.4 ± 3.4
53.2 ± 3.9
55.3 ± 3.5
GRU-D
64.6 ± 1.8
73.3 ± 3.6
63.5 ± 4.6
64.8 ± 3.6
64.8 ± 0.4
69.8 ± 0.8
65.8 ± 0.5
67.2 ± 0.0
SeFT
35.7 ± 0.5
42.1 ± 4.8
38.1 ± 1.3
35.0 ± 2.2
34.2 ± 2.8
34.9 ± 5.2
34.6 ± 2.1
33.3 ± 2.7
mTAND
33.2 ± 5.0
36.9 ± 3.7
37.7 ± 3.7
37.3 ± 3.4
45.6 ± 1.6
49.2 ± 2.1
49.0 ± 1.6
49.0 ± 1.0
RAINDROP
66.5 ± 4.0
72.0 ± 3.9
67.9 ± 5.8
65.1 ± 7.0
71.3 ± 2.5
75.8 ± 2.2
72.5 ± 2.0
73.4 ± 2.1
30%
Transformer
31.6 ± 10.0
26.4 ± 9.7
24.0 ± 10.0
19.0 ± 12.8
52.0 ± 11.9
55.2 ± 15.3
50.1 ± 13.3
48.4 ± 18.2
Trans-mean
42.5 ± 8.6
45.3 ± 9.6
37.0 ± 7.9
33.9 ± 8.2
65.1 ± 1.9
63.8 ± 1.2
67.9 ± 1.8
64.9 ± 1.7
GRU-D
45.1 ± 2.9
51.7 ± 6.2
42.1 ± 6.6
47.2 ± 3.9
58.0 ± 2.0
63.2 ± 1.7
58.2 ± 3.1
59.3 ± 3.5
SeFT
32.7 ± 2.3
27.9 ± 2.4
34.5 ± 3.0
28.0 ± 1.4
31.7 ± 1.5
31.0 ± 2.7
32.0 ± 1.2
28.0 ± 1.6
mTAND
27.5 ± 4.5
31.2 ± 7.3
30.6 ± 4.0
30.8 ± 5.6
34.7 ± 5.5
43.4 ± 4.0
36.3 ± 4.7
39.5 ± 4.4
RAINDROP
52.4 ± 2.8
60.9 ± 3.8
51.3 ± 7.1
48.4 ± 1.8
60.3 ± 3.5
68.1 ± 3.1
60.3 ± 3.6
61.9 ± 3.9
40%
Transformer
23.0 ± 3.5
7.4 ± 6.0
14.5 ± 2.6
6.9 ± 2.6
43.8 ± 14.0
44.6 ± 23.0
40.5 ± 15.9
40.2 ± 20.1
Trans-mean
25.7 ± 2.5
9.1 ± 2.3
18.5 ± 1.4
9.9 ± 1.1
48.7 ± 2.7
55.8 ± 2.6
54.2 ± 3.0
55.1 ± 2.9
GRU-D
46.4 ± 2.5
64.5 ± 6.8
42.6 ± 7.4
44.3 ± 7.9
47.7 ± 1.4
63.4 ± 1.6
44.5 ± 0.5
47.5 ± 0.0
SeFT
26.3 ± 0.9
29.9 ± 4.5
27.3 ± 1.6
22.3 ± 1.9
26.8 ± 2.6
24.1 ± 3.4
28.0 ± 1.2
23.3 ± 3.0
mTAND
19.4 ± 4.5
15.1 ± 4.4
20.2 ± 3.8
17.0 ± 3.4
23.7 ± 1.0
33.9 ± 6.5
26.4 ± 1.6
29.3 ± 1.9
RAINDROP
52.5 ± 3.7
53.4 ± 5.6
48.6 ± 1.9
44.7 ± 3.4
57.0 ± 3.1
65.4 ± 2.7
56.7 ± 3.1
58.9 ± 2.5
50%
Transformer
21.4 ± 1.8
2.7 ± 0.2
12.5 ± 0.4
4.4 ± 0.3
43.2 ± 2.5
52.0 ± 2.5
36.9 ± 3.1
41.9 ± 3.2
Trans-mean
21.3 ± 1.6
2.8 ± 0.4
12.5 ± 0.7
4.6 ± 0.2
46.4 ± 1.4
59.1 ± 3.2
43.1 ± 2.2
46.5 ± 3.1
GRU-D
37.3 ± 2.7
29.6 ± 5.9
32.8 ± 4.6
26.6 ± 5.9
49.7 ± 1.2
52.4 ± 0.3
42.5 ± 1.7
47.5 ± 1.2
SeFT
24.7 ± 1.7
15.9 ± 2.7
25.3 ± 2.6
18.2 ± 2.4
26.4 ± 1.4
23.0 ± 2.9
27.5 ± 0.4
23.5 ± 1.8
mTAND
16.9 ± 3.1
12.6 ± 5.5
17.0 ± 1.6
13.9 ± 4.0
20.9 ± 3.1
35.1 ± 6.1
23.0 ± 3.2
27.7 ± 3.9
RAINDROP
46.6 ± 2.6
44.5 ± 2.6
42.4 ± 3.9
38.0 ± 4.0
47.2 ± 4.4
59.4 ± 3.9
44.8 ± 5.3
47.6 ± 5.2
4.2
ABLATION STUDY AND VISUALIZATION OF OPTIMIZED SENSOR GRAPHS
Ablation study. Considering the PAM dataset and a typical setup (Setting 1), we conduct an ablation
study to evaluate how much various RAINDROP’s components contribute towards its ﬁnal performance.
We examine the following components: inter-sensor dependencies (further decomposed into weights
including ei,uv, rv, pt
i, and αt
i,uv), temporal attention, and sensor-level concatenation. We show
in Appendix A.14 (Table 7) that all model components are necessary and that regularization Lr
contributes positively to RAINDROP’s performance.
Visualizing sensor dependency graphs. We investigate whether samples with the same labels get
more similar sensor dependency graphs than samples with different labels. To this end, we visualize
inter-sensor dependencies (P19; Setting 1) and explore them. Figure 4 shows distinguishable patterns
between graphs of negative and positive samples, indicating that RAINDROP can extract relationships
that are speciﬁc to downstream sample labels. Further differential analysis provides insights that can
inform early detection of sepsis from P19 clinical data. Details are in Appendix A.15.
5
CONCLUSION
We introduce RAINDROP, a graph-guided network for irregularly sampled time series. RAINDROP
learns a distinct sensor dependency graph for every sample capturing time-varying dependencies be-
tween sensors. The ability to leverage graph structure gives RAINDROP unique capability to naturally
handle misaligned observations, non-uniform time intervals between successive observations, and
sensors with varying numbers of recorded observations. Our ﬁndings have implications for using
message passing as a way to leverage relational information in multivariate time series.
9
